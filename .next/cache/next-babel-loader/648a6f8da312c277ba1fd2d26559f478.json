{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/machoair/Desktop/react-test/next_app/components/AddressShow.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport Router from 'next/router';\nimport firebase from \"firebase\";\nimport Lib from '../static/address_lib';\nimport Account from '../components/Account';\n\nvar AddressShow = /*#__PURE__*/function (_Component) {\n  _inherits(AddressShow, _Component);\n\n  var _super = _createSuper(AddressShow);\n\n  function AddressShow(props) {\n    var _this;\n\n    _classCallCheck(this, AddressShow);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"style\", {\n      fontSize: \"12pt\",\n      padding: \"5px 10px\"\n    });\n\n    _this.state = {\n      last: -1,\n      input: '',\n      email: Router.query.email,\n      address: null,\n      message: Router.query.email + 'のデータ'\n    };\n    _this.logined = _this.logined.bind(_assertThisInitialized(_this));\n    _this.doChange = _this.doChange.bind(_assertThisInitialized(_this));\n    _this.doAction = _this.doAction.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(AddressShow, [{\n    key: \"logined\",\n    value: function logined() {\n      console.log('logined.');\n    }\n  }, {\n    key: \"logouted\",\n    value: function logouted() {\n      Router.push('/address');\n    }\n  }, {\n    key: \"getAddress\",\n    value: function getAddress(email) {\n      var db = firebase.database();\n      var ref0 = db.ref('address/' + Lib.encodeEmail(this.props.email) + '/' + Lib.encodeEmail(email) + '/check');\n      ref0.set(false);\n      var ref = db.ref('address/') + Lib.encodeEmail(this.props.email);\n      var self = this;\n      console.log(ref);\n      ref.orderByKey().equalTo(Lib.encodeEmail(email)).on('value', function (snapshot) {\n        for (var i in snapshot.val()) {\n          var d = Lib.deepcopy(snapshot.val()[i]);\n          self.setState({\n            address: d1\n          });\n          break;\n        }\n      });\n    }\n  }, {\n    key: \"doChange\",\n    value: function doChange(e) {\n      this.setState({\n        input: e.target.value\n      });\n    }\n  }, {\n    key: \"doAction\",\n    value: function doAction() {\n      var from = Lib.encodeEmail(this.props.email);\n      var to = Lib.encodeEmail(this.state.email);\n      var db = firebase.database();\n      var d = new Date().getTime();\n      var ref = db.ref('address/' + from + '/' + to + '/messages/' + d);\n      ref.set('to: ' + this.state.input);\n      var ref2 = db.ref('address/' + to + '/' + from + '/messages/' + d);\n      ref2.set('from: ' + this.state.input);\n      var ref3 = db.ref('address/' + to + '/' + from + '/check/');\n      ref3.set(true);\n      this.setState({\n        input: ''\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (this.props.login === false) {\n        Router.push('/address');\n      }\n\n      if (this.state.address === null) {\n        this.getAddress(Router.query.email);\n      }\n\n      var items = [];\n\n      if (this.state.address !== null) {\n        for (var n in this.state.address.messages) {\n          items.unshift( /*#__PURE__*/_jsxDEV(\"li\", {\n            children: this.state.address.messages[n]\n          }, n, false, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 23\n          }, this));\n        }\n      }\n\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(Account, {\n          onLogined: this.logined,\n          onLogouted: this.logouted\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: this.state.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 9\n        }, this), this.state.address !== null ? /*#__PURE__*/_jsxDEV(\"table\", {\n          children: /*#__PURE__*/_jsxDEV(\"tbody\", {\n            children: [/*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"NAME\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 102,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: this.state.address.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 103,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 101,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"MAIL\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 106,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: this.state.email\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 107,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 105,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"TEL\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 110,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: this.state.address.tel\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 111,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 109,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                children: \"MEMO\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 114,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: this.state.address.memo\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 115,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 113,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 9\n        }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"no-address\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"fieldset\", {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Message:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 124,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            size: \"40\",\n            value: this.state.input,\n            onChange: this.doChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: this.doAction,\n            children: \"send\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 9\n        }, this), this.state.address !== null ? /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"\\u203B\", this.state.address.name, \"\\u3055\\u3093\\u3068\\u306E\\u30E1\\u30C3\\u30BB\\u30FC\\u30B8\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n            children: item\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 132,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 9\n        }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"\\u203B\\u30E1\\u30C3\\u30BB\\u30FC\\u30B8\\u306F\\u3042\\u308A\\u307E\\u305B\\u3093\\u3002\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 7\n      }, this);\n    }\n  }]);\n\n  return AddressShow;\n}(Component);\n\nAddressShow = connect(function (state) {\n  return state;\n})(AddressShow);\nexport default AddressShow;","map":{"version":3,"sources":["/Users/machoair/Desktop/react-test/next_app/components/AddressShow.js"],"names":["React","Component","connect","Router","firebase","Lib","Account","AddressShow","props","fontSize","padding","state","last","input","email","query","address","message","logined","bind","doChange","doAction","console","log","push","db","database","ref0","ref","encodeEmail","set","self","orderByKey","equalTo","on","snapshot","i","val","d","deepcopy","setState","d1","e","target","value","from","to","Date","getTime","ref2","ref3","login","getAddress","items","n","messages","unshift","logouted","name","tel","memo","item"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport { connect } from 'react-redux';\nimport Router from 'next/router';\nimport firebase from \"firebase\";\nimport Lib from '../static/address_lib';\nimport Account from '../components/Account';\n\n\nclass AddressShow extends Component {\n  style = {\n    fontSize: \"12pt\",\n    padding: \"5px 10px\"\n  }\n\n  constructor(props){\n    super(props);\n    \n    this.state = {\n      last: -1,\n      input: '',\n      email: Router.query.email,\n      address: null,\n      message: Router.query.email + 'のデータ'\n    }\n    this.logined = this.logined.bind(this);\n    this.doChange = this.doChange.bind(this);\n    this.doAction = this.doAction.bind(this);\n  }\n\n  logined(){\n    console.log('logined.');\n  }\n  logouted(){\n    Router.push('/address')\n  }\n\n  getAddress(email){\n    let db = firebase.database();\n    let ref0 = db.ref('address/' + Lib.encodeEmail(this.props.email) + '/' + Lib.encodeEmail(email) + '/check');\n    ref0.set(false);\n    let ref = db.ref('address/') + Lib.encodeEmail(this.props.email);\n    let self = this;\n    console.log(ref);\n    ref.orderByKey()\n      .equalTo(Lib.encodeEmail(email))\n      .on('value', (snapshot)=>{\n        for(let i in snapshot.val()){\n          let d = Lib.deepcopy(snapshot.val()[i]);\n          self.setState({\n            address: d1\n          });\n          break;\n        }\n      });\n  }\n\n  doChange(e){\n    this.setState({\n      input: e.target.value\n    });\n  }\n\n  doAction(){\n    let from = Lib.encodeEmail(this.props.email);\n    let to = Lib.encodeEmail(this.state.email);\n    let db = firebase.database();\n    let d = new Date().getTime();\n    let ref = db.ref('address/' + from + '/' + to + '/messages/' + d);\n    ref.set('to: ' + this.state.input);\n    let ref2 = db.ref('address/' + to + '/' + from + '/messages/' + d);\n    ref2.set('from: ' + this.state.input);\n    let ref3 = db.ref('address/' + to + '/' + from + '/check/');\n    ref3.set(true);\n    this.setState({ input: '' })\n  }\n\n  render(){\n    if (this.props.login === false){\n      Router.push('/address');\n    }\n    if (this.state.address === null){\n      this.getAddress(Router.query.email);\n    }\n    let items = [];\n    if (this.state.address !== null){\n      for(let n in this.state.address.messages){\n        items.unshift(<li key={n}>\n          {this.state.address.messages[n]}\n        </li>);\n      }\n    }\n    return (\n      <div>\n        <Account onLogined={this.logined} onLogouted={this.logouted} />\n        <p>{this.state.message}</p>\n        <hr />\n        {this.state.address !== null\n        ?\n        <table>\n          <tbody>\n            <tr>\n              <th>NAME</th>\n              <td>{this.state.address.name}</td>\n            </tr>\n            <tr>\n              <th>MAIL</th>\n              <td>{this.state.email}</td>\n            </tr>\n            <tr>\n              <th>TEL</th>\n              <td>{this.state.address.tel}</td>\n            </tr>\n            <tr>\n              <th>MEMO</th>\n              <td>{this.state.address.memo}</td>\n            </tr>\n          </tbody>\n        </table>\n        :\n        <p>no-address</p>\n        }\n        <hr />\n        <fieldset>\n          <p>Message:</p>\n          <input type=\"text\" size=\"40\" value={this.state.input} onChange={this.doChange} />\n          <button onClick={this.doAction}>send</button>\n        </fieldset>\n        {this.state.address !== null\n        ?\n        <div>\n          <p>※{this.state.address.name}さんとのメッセージ</p>\n          <ul>{item}</ul>\n        </div>\n        :\n        <p>※メッセージはありません。</p>\n        }\n      </div>\n    );\n  }\n}\nAddressShow = connect((state)=> state)(AddressShow);\nexport default AddressShow;"]},"metadata":{},"sourceType":"module"}